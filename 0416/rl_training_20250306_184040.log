2025-03-06 18:40:40,621 - __main__ - INFO - 加载配置文件: rl_configs/tkg-agent.yaml
2025-03-06 18:40:40,621 - __main__ - ERROR - 加载配置文件时出错: Expecting value: line 1 column 1 (char 0)
2025-03-06 18:40:40,621 - __main__ - INFO - 使用默认配置
2025-03-06 18:40:40,624 - __main__ - INFO - 加载数据集: ICEWS18 (仅训练集用于搜索空间)
2025-03-06 18:40:46,379 - __main__ - INFO - 只使用训练集构建了搜索空间 (不包含验证集数据)
2025-03-06 18:40:46,421 - __main__ - INFO - 准备验证数据完成，共 15351 个样本
2025-03-06 18:40:46,435 - __main__ - INFO - 加载模型: /data/shangyuan/models/DeepSeek-R1-Distill-Qwen-1.5B
2025-03-06 18:40:46,525 - __main__ - INFO - 自动选择最空闲的GPU: 7
2025-03-06 18:40:46,526 - __main__ - INFO - 使用设备: cuda:7
2025-03-06 18:40:52,741 - __main__ - INFO - GPU总内存: 23.69 GB
2025-03-06 18:40:52,745 - __main__ - INFO - 模型参数量: 1777.09M
2025-03-06 18:40:52,820 - __main__ - INFO - 分词器词汇表大小: 151665
2025-03-06 18:40:52,820 - __main__ - INFO - 模型隐藏层维度: 1536
2025-03-06 18:40:52,820 - __main__ - INFO - 验证模型生成能力...
2025-03-06 18:40:53,980 - __main__ - INFO - 测试生成完成，输出长度: 8
2025-03-06 18:40:53,981 - __main__ - INFO - 初始化TKG环境，最大步数: 5, 奖励缩放: 1.0, 特征类型: query_context
2025-03-06 18:40:53,982 - src.rl.tkg_environment - INFO - TKG环境初始化，模型运行在设备: cuda:7
2025-03-06 18:40:53,982 - src.rl.tkg_environment - INFO - 使用特征提取类型: query_context, 特征维度: 1536
2025-03-06 18:40:54,217 - __main__ - INFO - 环境状态维度: 7680
2025-03-06 18:40:54,218 - __main__ - INFO - 环境动作维度: 1536
2025-03-06 18:40:54,493 - src.rl.agents.dqn_agent - INFO - setting up scheduler with base_lr=0.01, max_lr=0.01, step_size_up=100000, step_size_down=None
2025-03-06 18:40:54,494 - src.rl.agents.dqn_agent - INFO - no existing checkpoints, train from scratch...
2025-03-06 18:40:54,494 - __main__ - INFO - 初始化wandb，项目：ATKGF，名称：tkg-rl-icews18-query_context，组：tkg-active-learning
2025-03-06 18:40:58,114 - __main__ - INFO - 开始训练RL代理，总步数: 1500
2025-03-06 18:40:58,303 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Traian Basescu, Criticize or denounce, 6480
2025-03-06 18:40:58,334 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Criminal (Netherlands), Threaten with military force, 6480
2025-03-06 18:40:58,909 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Medical Personnel (India), Provide humanitarian aid, 6480
2025-03-06 18:40:59,566 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Saudi Army, Praise or endorse, 6480
2025-03-06 18:40:59,600 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Military (South Sudan), Express intent to engage in diplomatic cooperation (such as policy support), 6480
2025-03-06 18:41:00,020 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Police (Somalia), Mobilize or increase police power, 6480
2025-03-06 18:41:01,335 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Domestic Affairs (Cote d'Ivoire), Consult, 6480
2025-03-06 18:41:02,606 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Domestic Affairs (Croatia), Praise or endorse, 6480
2025-03-06 18:41:02,911 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Libya, Cooperate economically, 6480
2025-03-06 18:41:04,148 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Military (Burkina Faso), Engage in symbolic act, 6480
2025-03-06 18:41:05,590 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Envoy (Saudi Arabia), Sign formal agreement, 6480
2025-03-06 18:41:06,512 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Alassane Ouattara, Return, release person(s), 6480
2025-03-06 18:41:06,552 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Mandla Mandela, Consult, 6480
2025-03-06 18:41:08,178 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Salome Zourabichvili, Criticize or denounce, 6480
2025-03-06 18:41:09,205 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Refugee (Greece), Express intent to meet or negotiate, 6480
2025-03-06 18:41:09,565 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Bharatiya Janata, Acknowledge or claim responsibility, 6480
2025-03-06 18:41:11,547 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Foreign Affairs (United States), Use unconventional violence, 6480
2025-03-06 18:41:12,596 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Economist (Mexico), Make pessimistic comment, 6480
2025-03-06 18:41:13,677 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Balwant Singh, Arrest, detain, or charge with legal action, 6480
2025-03-06 18:41:16,207 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Salzburg, Host a visit, 6480
2025-03-06 18:41:16,290 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Citizen (Russia), Appeal for intelligence, 6480
2025-03-06 18:41:16,597 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Canada), Accede to demands for change in policy, 6480
2025-03-06 18:41:16,856 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Militant (India), Accuse, 6480
2025-03-06 18:41:17,246 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Police (Slovakia), Make an appeal or request, 6480
2025-03-06 18:41:18,389 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Regulator (Australia), Demand, 6480
2025-03-06 18:41:18,760 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Boris Johnson, Express intent to cooperate economically, 6480
2025-03-06 18:41:18,894 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Cuba, Defend verbally, 6480
2025-03-06 18:41:18,976 - src.rl.tkg_environment - WARNING - 样本预测结果为空: United Nations Human Rights Council, Make pessimistic comment, 6480
2025-03-06 18:41:20,608 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Akali Leader, Demand material cooperation, 6480
2025-03-06 18:41:20,745 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Anies Baswedan, Praise or endorse, 6480
2025-03-06 18:41:23,304 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Saint Lucia, Appeal for diplomatic cooperation (such as policy support), 6480
2025-03-06 18:41:23,800 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Israel, Abduct, hijack, or take hostage, 6480
2025-03-06 18:41:24,140 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Pakistan), Use conventional military force, 6480
2025-03-06 18:41:24,184 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Police (Slovakia), Demand change in leadership, 6480
2025-03-06 18:41:24,228 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Residents of the Capital (Yemen), Demonstrate or rally, 6480
2025-03-06 18:41:24,756 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Militia (Revolutionary Guards), Accuse, 6480
2025-03-06 18:41:24,908 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Fire Brigade (Nigeria), Cooperate militarily, 6480
2025-03-06 18:41:25,315 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Military (Afghanistan), Threaten with military force, 6480
2025-03-06 18:41:25,579 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Italy), Defy norms, law, 6480
2025-03-06 18:41:26,134 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Businessperson (India), Threaten with military force, 6480
2025-03-06 18:41:26,263 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Refugee (Palestinian Territory, Occupied), Make optimistic comment, 6480
2025-03-06 18:41:26,436 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Cameroon), Criticize or denounce, 6480
2025-03-06 19:26:52,447 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Jamal Khashoggi, Demand, 6864
2025-03-06 19:29:27,946 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Jamal Khashoggi, Demand, 6888
2025-03-06 19:44:05,058 - src.rl.agents.dqn_agent - INFO - 选择了exit_action (原始索引: 523), 转换为: -1
2025-03-06 19:44:05,059 - src.rl.tkg_environment - INFO - 选择了终止动作，停止当前时间戳的采样
2025-03-06 20:16:42,227 - src.rl.agents.dqn_agent - INFO - 训练进度: 0/1500 (0.0%), 奖励: 0.0000, MRR: 0.0000, 时间戳: 7272/34, 预计剩余: 计算中...
2025-03-06 20:16:42,882 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Traian Basescu, Criticize or denounce, 6480
2025-03-06 20:16:42,917 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Criminal (Netherlands), Threaten with military force, 6480
2025-03-06 20:16:43,481 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Medical Personnel (India), Provide humanitarian aid, 6480
2025-03-06 20:16:44,122 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Saudi Army, Praise or endorse, 6480
2025-03-06 20:16:44,157 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Military (South Sudan), Express intent to engage in diplomatic cooperation (such as policy support), 6480
2025-03-06 20:16:44,561 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Police (Somalia), Mobilize or increase police power, 6480
2025-03-06 20:16:45,923 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Domestic Affairs (Cote d'Ivoire), Consult, 6480
2025-03-06 20:16:47,133 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Domestic Affairs (Croatia), Praise or endorse, 6480
2025-03-06 20:16:47,425 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Libya, Cooperate economically, 6480
2025-03-06 20:16:48,653 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Military (Burkina Faso), Engage in symbolic act, 6480
2025-03-06 20:16:50,058 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Envoy (Saudi Arabia), Sign formal agreement, 6480
2025-03-06 20:16:50,978 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Alassane Ouattara, Return, release person(s), 6480
2025-03-06 20:16:51,012 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Mandla Mandela, Consult, 6480
2025-03-06 20:16:52,625 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Salome Zourabichvili, Criticize or denounce, 6480
2025-03-06 20:16:53,661 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Refugee (Greece), Express intent to meet or negotiate, 6480
2025-03-06 20:16:54,023 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Bharatiya Janata, Acknowledge or claim responsibility, 6480
2025-03-06 20:16:55,933 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Foreign Affairs (United States), Use unconventional violence, 6480
2025-03-06 20:16:56,954 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Economist (Mexico), Make pessimistic comment, 6480
2025-03-06 20:16:58,007 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Balwant Singh, Arrest, detain, or charge with legal action, 6480
2025-03-06 20:17:00,410 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Salzburg, Host a visit, 6480
2025-03-06 20:17:00,486 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Citizen (Russia), Appeal for intelligence, 6480
2025-03-06 20:17:00,785 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Canada), Accede to demands for change in policy, 6480
2025-03-06 20:17:01,039 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Militant (India), Accuse, 6480
2025-03-06 20:17:01,405 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Police (Slovakia), Make an appeal or request, 6480
2025-03-06 20:17:02,521 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Regulator (Australia), Demand, 6480
2025-03-06 20:17:02,858 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Boris Johnson, Express intent to cooperate economically, 6480
2025-03-06 20:17:02,975 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Cuba, Defend verbally, 6480
2025-03-06 20:17:03,055 - src.rl.tkg_environment - WARNING - 样本预测结果为空: United Nations Human Rights Council, Make pessimistic comment, 6480
2025-03-06 20:17:04,680 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Akali Leader, Demand material cooperation, 6480
2025-03-06 20:17:04,807 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Anies Baswedan, Praise or endorse, 6480
2025-03-06 20:17:07,244 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Saint Lucia, Appeal for diplomatic cooperation (such as policy support), 6480
2025-03-06 20:17:07,727 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Israel, Abduct, hijack, or take hostage, 6480
2025-03-06 20:17:08,052 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Pakistan), Use conventional military force, 6480
2025-03-06 20:17:08,091 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Police (Slovakia), Demand change in leadership, 6480
2025-03-06 20:17:08,131 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Residents of the Capital (Yemen), Demonstrate or rally, 6480
2025-03-06 20:17:08,641 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Militia (Revolutionary Guards), Accuse, 6480
2025-03-06 20:17:08,787 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Fire Brigade (Nigeria), Cooperate militarily, 6480
2025-03-06 20:17:09,174 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Military (Afghanistan), Threaten with military force, 6480
2025-03-06 20:17:09,419 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Italy), Defy norms, law, 6480
2025-03-06 20:17:09,933 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Businessperson (India), Threaten with military force, 6480
2025-03-06 20:17:10,056 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Refugee (Palestinian Territory, Occupied), Make optimistic comment, 6480
2025-03-06 20:17:10,225 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Cameroon), Criticize or denounce, 6480
2025-03-06 20:42:16,628 - src.rl.tkg_environment - WARNING - 样本预测结果为空: United Nations Mission in Liberia, Provide aid, 6744
2025-03-06 21:20:47,970 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Jamal Khashoggi, Demand, 7104
2025-03-06 21:40:41,860 - src.rl.agents.dqn_agent - INFO - 训练进度: 1/1500 (0.1%), 奖励: 0.0000, MRR: 0.0000, 时间戳: 7272/34, 预计剩余: 计算中...
2025-03-06 21:40:42,238 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Traian Basescu, Criticize or denounce, 6480
2025-03-06 21:40:42,274 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Criminal (Netherlands), Threaten with military force, 6480
2025-03-06 21:40:42,831 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Medical Personnel (India), Provide humanitarian aid, 6480
2025-03-06 21:40:43,474 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Saudi Army, Praise or endorse, 6480
2025-03-06 21:40:43,509 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Military (South Sudan), Express intent to engage in diplomatic cooperation (such as policy support), 6480
2025-03-06 21:40:43,924 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Police (Somalia), Mobilize or increase police power, 6480
2025-03-06 21:40:45,304 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Domestic Affairs (Cote d'Ivoire), Consult, 6480
2025-03-06 21:40:46,541 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Domestic Affairs (Croatia), Praise or endorse, 6480
2025-03-06 21:40:46,835 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Libya, Cooperate economically, 6480
2025-03-06 21:40:48,074 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Military (Burkina Faso), Engage in symbolic act, 6480
2025-03-06 21:40:49,517 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Envoy (Saudi Arabia), Sign formal agreement, 6480
2025-03-06 21:40:50,426 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Alassane Ouattara, Return, release person(s), 6480
2025-03-06 21:40:50,462 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Mandla Mandela, Consult, 6480
2025-03-06 21:40:52,085 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Salome Zourabichvili, Criticize or denounce, 6480
2025-03-06 21:40:53,115 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Refugee (Greece), Express intent to meet or negotiate, 6480
2025-03-06 21:40:53,477 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Bharatiya Janata, Acknowledge or claim responsibility, 6480
2025-03-06 21:40:55,422 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Foreign Affairs (United States), Use unconventional violence, 6480
2025-03-06 21:40:56,472 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Economist (Mexico), Make pessimistic comment, 6480
2025-03-06 21:40:57,563 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Balwant Singh, Arrest, detain, or charge with legal action, 6480
2025-03-06 21:41:00,039 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Salzburg, Host a visit, 6480
2025-03-06 21:41:00,118 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Citizen (Russia), Appeal for intelligence, 6480
2025-03-06 21:41:00,428 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Canada), Accede to demands for change in policy, 6480
2025-03-06 21:41:00,688 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Militant (India), Accuse, 6480
2025-03-06 21:41:01,069 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Police (Slovakia), Make an appeal or request, 6480
2025-03-06 21:41:02,203 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Regulator (Australia), Demand, 6480
2025-03-06 21:41:02,545 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Boris Johnson, Express intent to cooperate economically, 6480
2025-03-06 21:41:02,662 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Cuba, Defend verbally, 6480
2025-03-06 21:41:02,742 - src.rl.tkg_environment - WARNING - 样本预测结果为空: United Nations Human Rights Council, Make pessimistic comment, 6480
2025-03-06 21:41:04,352 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Akali Leader, Demand material cooperation, 6480
2025-03-06 21:41:04,483 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Anies Baswedan, Praise or endorse, 6480
2025-03-06 21:41:07,015 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Saint Lucia, Appeal for diplomatic cooperation (such as policy support), 6480
2025-03-06 21:41:07,494 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Israel, Abduct, hijack, or take hostage, 6480
2025-03-06 21:41:07,750 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Pakistan), Use conventional military force, 6480
2025-03-06 21:41:07,790 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Police (Slovakia), Demand change in leadership, 6480
2025-03-06 21:41:07,830 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Residents of the Capital (Yemen), Demonstrate or rally, 6480
2025-03-06 21:41:08,350 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Militia (Revolutionary Guards), Accuse, 6480
2025-03-06 21:41:08,497 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Fire Brigade (Nigeria), Cooperate militarily, 6480
2025-03-06 21:41:08,883 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Military (Afghanistan), Threaten with military force, 6480
2025-03-06 21:41:09,136 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Italy), Defy norms, law, 6480
2025-03-06 21:41:09,658 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Businessperson (India), Threaten with military force, 6480
2025-03-06 21:41:09,785 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Refugee (Palestinian Territory, Occupied), Make optimistic comment, 6480
2025-03-06 21:41:09,952 - src.rl.tkg_environment - WARNING - 样本预测结果为空: Government (Cameroon), Criticize or denounce, 6480
2025-03-06 21:54:47,861 - src.rl.tkg_environment - WARNING - 样本预测结果为空: New Rights Party of Georgia, Make statement, 6624
